<?xml version="1.0" encoding="UTF-8"?>
 
<widgets xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Widget:etc/widget.xsd">
      
    <widget id="popup_timer" class="Magebird\Popup\Block\Widget\Timer">
        <label translate="true">Magebird Popup Countdown Timer</label>
        <description>Adds Countdown Timer into popup</description>
        <parameters> 
            <parameter name="widget_id" xsi:type="text" required="true" visible="false">          
            </parameter>
            <parameter name="timeout_type" xsi:type="select" required="true" visible="true" sort_order="1">
                <label translate="true">Countdown to</label>
                <description>
                <![CDATA[
                <script>            
                  setTimeout(function(){ 
                      jQuery("#widget_options input[name='parameters\[widget_id\]']").val("_"+Math.random().toString(36).substr(2, 4));                                    
                }, 1000);
                </script>                  
                Choose 'Set number of minutes' if you want timer to stop dynamically for each visitors at different time (for example if you want to offer discount if visitor complete an order in next 5 minutes). Choose 'Specific date' if timer should start and stop for all visitors at the same time (for example if you have time limited offer that will run 3 days)
                ]]>
                </description>
                <options>
                    <option name="value_one" value="1" selected="true">
                        <label translate="true">Set number of minutes</label>
                    </option>
                    <option name="two" value="2">
                        <label translate="true">Specific date</label>
                    </option>
                    <option name="three" value="3">
                        <label translate="true">Inherit from other popup timer</label>
                    </option>              
                </options>
            </parameter>  
            <parameter name="to_date" xsi:type="text"  visible="true" sort_order="2" >
                <label>Finish Date</label>   
                <description><![CDATA[Write date time in the exact format yyyy-MM-dd HH:mm:ss. Time will be based on store timezone settings (System->Configuration->General->Locale Options->Timezone)]]></description>
                <depends>
                    <parameter name="timeout_type" value="2" />
                </depends>                                                       
            </parameter>   
      			<parameter name="minutes" xsi:type="text"  visible="true" sort_order="3" >
      				<label translate="true">Countdown minutes</label>               
              <description><![CDATA[Total time in minutes starting to countdown when popup shows up. 1 day = 1440 minutes.]]></description>
              <depends>
                  <parameter name="timeout_type" value="1" />
              </depends>                      
      			</parameter>                                        
      			<parameter name="popup_inherit_id" xsi:type="text"  visible="true" sort_order="4" >
      				<label translate="true">Inherited popup id</label>
              <description>
              <![CDATA[                                
              If you want minutes to inherit from time of other popup write id of popup from which you want to inherit the timer.
              ]]>
              </description>
              <depends>
                  <parameter name="timeout_type" value="3" />
              </depends>        
      			</parameter>    
            <parameter name="on_timeout" xsi:type="select" required="true" visible="true" sort_order="5">
                <label translate="true">On countdown action</label>
                <description><![CDATA[Choose 'Set number of minutes' if you want timer to stop dynamically for each visitors at different time (for example if you want to offer discount if visitor complete an order in next 5 minutes). Choose 'Specific date' if timer should start and stop for all visitors at the same time (for example if you have time limited offer that will run 3 days)]]></description>
                <options>
                    <option name="one" value="1" selected="true">
                        <label translate="true">No action</label>
                    </option>
                    <option name="two" value="2">
                        <label translate="true">Close popup</label>
                    </option>
                    <option name="three" value="3">
                        <label translate="true">Display message</label>
                    </option>              
                </options>
            </parameter>            

            <parameter name="style" xsi:type="block" required="true" visible="true" sort_order="6">
                <label translate="true">Countdown Template</label>                   
                <block class="Magebird\Popup\Block\Adminhtml\Widget\TimerChooser">
                    <data>
                        <item name="button" xsi:type="array">
                            <item name="open" xsi:type="string">Select Countdown Template...</item>
                        </item>
                    </data>
                </block>               
            </parameter>

            <parameter name="template" xsi:type="text" required="true" visible="false" sort_order="7">
                <label translate="true">Countdown Template</label>                   
                <value>widget/timer/main.phtml</value>               
            </parameter>
            <parameter name="timer_size" xsi:type="text" required="true" visible="true">
              <label translate="true">Timer Text Size (in px)</label>
              <value>14</value> 
            </parameter>
			<parameter name="success_msg" xsi:type="block"  visible="true" sort_order="8" >
				<label translate="true">Text/content after countdown timer ends</label>        
        <description>
        <![CDATA[
        Text/content that will be shown after user clicks button. Html code is allowed. You can use popup editor to design your content and then copy html here.
        <script>                  
          //this belong to success_msg field
          setTimeout(function(){                                                                                                                      
              jQuery("#insert_button").attr('onclick','').unbind('click');  
              jQuery("#insert_button").click(function(){
                  setTimeout(function(){
                    var templateValue = jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val();
                    templateValue = encodeURI(templateValue).replace(/'/g, "%27"); 
                    jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val(templateValue);                                                               
                    wWidget.insertWidget()                          
                  }, 100);   
                  //for case if error appeared, to prevent double encode on next insertWidget
                  setTimeout(function(){  
                    var templateValue = jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val();
                    templateValue = decodeURI(templateValue);
                    jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val(templateValue);                                                                                         
                  }, 200);                                                                                                                                                              
              });                
        }, 1000);
        </script>                                          
        Text/content that will be shown after countdown timer goes to 0.</i></span><br />Tip: Html code is allowed. You can use popup editor to design your content and then copy html here.
        ]]>
        </description>
        <block class="Magebird\Popup\Block\Adminhtml\Widget\SuccessMsg">                
        </block>                                    
			</parameter> 
      </parameters>
    </widget>  
	<widget id="popup_buttons" class="Magebird\Popup\Block\Widget\Buttons">
		<label translate="true">Magebird Popup Buttons</label>
		<description>Add button into popup</description>
		<parameters>
      <parameter name="widget_id" xsi:type="text" visible="false" required="true" sort_order="1" >
          <label translate="true">Widget id</label>
      </parameter>        
      <parameter name="template" xsi:type="block" required="true" visible="true" sort_order="2">
          <label translate="true">Button design</label>  
          <description>
                <![CDATA[
                <script>
                  jQuery('body').on('change', "#widget_options select[name='parameters\[coupon_type\]']", function(){                      
                    couponTypeListener();
                  });     

                  function couponTypeListener(){
                      var couponType = jQuery("#widget_options select[name='parameters\[coupon_type\]']").val();
                      if(couponType==0){
                        jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().hide();
                        jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().hide();
                        jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().hide();
                        
                        }else if (couponType==2){
                        jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().show();
                        jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().show();
                        jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().show();
                        
                      }else{
                        jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().hide();
                        jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().show();
                        jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().show();
                      }    
                  }  
                                 
                  setTimeout(function(){ 
                      couponTypeListener(); 
                      jQuery("#widget_options input[name='parameters\[widget_id\]']").val("_"+Math.random().toString(36).substr(2, 4));                    
                      //this belong to success_msg field
                      jQuery("#insert_button").attr('onclick','').unbind('click');
                      jQuery("#insert_button").click(function(){
                          setTimeout(function(){
                            var templateValue = jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val();
                            templateValue = encodeURI(templateValue).replace(/'/g, "%27"); 
                            jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val(templateValue);                                                               
                            wWidget.insertWidget()                          
                          }, 100);   
                          //for case if error appeared, to prevent double encode on next insertWidget
                          setTimeout(function(){  
                            var templateValue = jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val();
                            templateValue = decodeURI(templateValue);
                            jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val(templateValue);                                                                                         
                          }, 200);                                                                                 
                                                                             
                      });                
                }, 1000);
                </script>                              
                ]]>
          </description>                    
          <block class="Magebird\Popup\Block\Adminhtml\Widget\ButtonChooser">
              <data>
                  <item name="button" xsi:type="array">
                      <item name="open" xsi:type="string">Select Button...</item>
                  </item>
              </data>
          </block> 
      </parameter> 
			<parameter name="button_text" xsi:type="text" required="true" visible="true" sort_order="3" >
				<label translate="true">Button text</label>
			</parameter>
			<parameter name="button_color" xsi:type="text" required="true" visible="true" sort_order="4" >
				<label translate="true">Button color</label>
        <description><![CDATA[Use the Hex value and <a target="_blank" href="http://www.colorpicker.com/">Colorpicker.com</a> to pick color.]]></description>
        <value>#ea7d00</value>
			</parameter>
			<parameter name="buttontext_color" xsi:type="text"  visible="true" sort_order="5" >
				<label translate="true">Button text color</label>
        <description><![CDATA[Default is #FFFFFF (white). Use Hex value. You can use <a target="_blank" href="http://www.colorpicker.com/">Colorpicker.com</a> to pick color.]]></description>
        <value>#FFFFFF</value>        
			</parameter>    			
      <parameter name="button_size" xsi:type="select" source_model="Magebird\Popup\Model\Widget\Source\Buttonsize" visible="true" sort_order="6">      
				<label translate="true">Button size</label>              
			</parameter> 
      <parameter name="on_click" xsi:type="select" required="true" visible="true" sort_order="7">
          <label translate="true">On-click action</label>
          <description translate="true"><![CDATA[Select the action to implement after the user clicks the button.]]></description>
          <options>
              <option name="one" value="1" selected="true">
                  <label translate="true">Display message and/or coupon code</label>
              </option>
              <option name="two" value="2">
                  <label translate="true">Redirect to URL</label>
              </option>
              <option name="three" value="3">
                  <label translate="true">Close popup</label>
              </option>              
          </options>
      </parameter>  
      <parameter name="coupon_type" xsi:type="select" required="true" visible="true" sort_order="8">
          <label translate="true">Coupon type</label>
          <description translate="true"><![CDATA[Select to send/display a coupon code after the user clicks the button.]]></description>
          <depends>
              <parameter name="on_click" value="1" />
          </depends> 
          <options>
              <option name="one" value="0" selected="true">
                  <label translate="true">No coupon</label>
              </option>
              <option name="two" value="1">
                  <label translate="true">Specific static coupon code</label>
              </option>
              <option name="three" value="2">
                  <label translate="true">Auto generate dynamic coupon code for each customer</label>
              </option>              
          </options>
      </parameter>       
			<parameter name="coupon_code" xsi:type="text"  visible="true" sort_order="9">
				<label translate="true">Coupon code</label>
        <description><![CDATA[Write coupon code you want to be sent to subscribed users]]></description>
        <depends>
            <parameter name="coupon_type" value="1" />
        </depends>               
			</parameter>  
			<parameter name="rule_id" xsi:type="select" source_model="Magebird\Popup\Model\Widget\Source\Rules" visible="true" sort_order="10" >
				<label translate="true">Shopping Cart Price Rule ID for Coupon</label>                              
        <description><![CDATA[Choose your shoping cart rule you want to be used to generate coupons. Only rules with field <a href="http://www.magebird.com/magento-extensions/popup-2.html?tab=faq#dynamicCoupon">Use Auto Generation</a> checked on can be used. If you want to use static coupon code change "Coupon type" the above. See instructions <a href="http://www.magebird.com/magento-extensions/popup-2.html?tab=faq#dynamicCoupon">here</a>.]]></description>
        <depends>
            <parameter name="coupon_type" value="2" />
        </depends>        
			</parameter> 
			<parameter name="coupon_length" xsi:type="text"  visible="true" sort_order="11" >
				<label translate="true">Coupon length</label>
        <depends>
            <parameter name="coupon_type" value="2" />
        </depends>  
        <value>12</value>             
			</parameter>     
			<parameter name="coupon_prefix" xsi:type="text"  visible="true" sort_order="12" >
				<label translate="true">Coupon prefix</label>
        <description><![CDATA[Leave empty if you don't want prefix]]></description>
        <depends>
            <parameter name="coupon_type" value="2" />
        </depends>               
			</parameter>  
			<parameter name="coupon_expiration" xsi:type="text"  visible="true" sort_order="13" >
				<label translate="true">Coupon expiration (in minutes)</label>
        <description><![CDATA[Leave empty if you want to use global settings from Shopping Cart Rule. Write minutes if you want coupon code to expire in defined minutes after user receives it. 1 day = 1440 minutes.]]></description>
        <depends>
            <parameter name="coupon_type" value="2" />
        </depends>       
			</parameter>       
      <parameter name="apply_coupon" xsi:type="select" required="true" visible="true" sort_order="13">
          <label translate="true">Auto-apply coupon to cart</label>
          <description><![CDATA[If set to Yes, the user doesn't need to enter the coupon code in cart, it'll get applied automatically.]]></description>
          <options>
              <option name="yes" value="1" selected="true">
                  <label translate="true">Yes</label>
              </option>
              <option name="no" value="2">
                  <label translate="true">No</label>
              </option>            
          </options>
      </parameter> 
			<parameter name="success_msg" xsi:type="block"  visible="true" sort_order="22" >
				<label translate="true">Text/content after user clicks button</label>
        <description><![CDATA[Text/content that will be shown after the user clicks the button on the popup. To display the <b style="color:#f80000">coupon code</b> inside, use '<b>{{var coupon_code}}</b>'. {{var coupon_code}} will be then replaced with your coupon code. Example: Your coupon is: {{var coupon_code}}. Tip: HTML code is allowed. You can use the popup editor to design your content and then copy-paste it here.]]></description>      
        <block class="Magebird\Popup\Block\Adminhtml\Widget\SuccessMsg">                
        </block>              
			</parameter> 
			<parameter name="button_href" xsi:type="text"  visible="true" sort_order="14">
				<label translate="true">Button href (link)</label>
        <description><![CDATA[Url of page to where the button should link.]]></description>
        <depends>
            <parameter name="on_click" value="2" />
        </depends>               
			</parameter>   
      <parameter name="link_target" xsi:type="select" required="true" visible="true" sort_order="15">
          <label translate="true">Open link in</label>
          <depends>
              <parameter name="on_click" value="2" />
          </depends> 
          <options>
              <option name="value_one" value="1" selected="true">
                  <label translate="true">Current window</label>
              </option>
              <option name="value_two" value="2">
                  <label translate="true">New window</label>
              </option>            
          </options>
      </parameter>                                                                
    </parameters>     
  </widget>
  <widget id="popup_newsletter" class="Magebird\Popup\Block\Widget\Newsletter">
		<label translate="true">Magebird Popup Newsletter</label>
		<description>Add newsletter form into popup</description>
		<parameters>   
      <parameter name="widget_id" xsi:type="text" visible="false" required="true" sort_order="1" >
          <label translate="true">Widget id</label>
      </parameter> 
      <parameter name="template" xsi:type="block" required="true" visible="true" sort_order="2">
          <label translate="true">Newsletter form template</label>  
          <description>
                <![CDATA[
                <script> 
                //todo: confirm needed does not show!! 
                  jQuery('body').on('change', "#widget_options select[name='parameters\[coupon_type\]']", function(){                      
                    couponTypeListener();
                  });     

                  function couponTypeListener(){
                      var couponType = jQuery("#widget_options select[name='parameters\[coupon_type\]']").val();
                      if(couponType==0){
                        jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().hide();
                        jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().hide();
                        jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().hide();
                       }else if (couponType==2){
                        jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().show();
                        jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().show();
                        jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().show();
                        
                      }else{
                        jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().hide();
                        jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().show();
                        jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().show();
                      }
                  }  
                                 
                  setTimeout(function(){ 
                      couponTypeListener(); 
                      jQuery("#widget_options input[name='parameters\[widget_id\]']").val("_"+Math.random().toString(36).substr(2, 4));                    
                      //this belong to success_msg field
                      jQuery("#insert_button").attr('onclick','').unbind('click');
                      jQuery("#insert_button").click(function(){
                          setTimeout(function(){
                            var templateValue = jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val();
                            templateValue = encodeURI(templateValue).replace(/'/g, "%27"); 
                            jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val(templateValue);                                                               
                            wWidget.insertWidget()                          
                          }, 100);   
                          //for case if error appeared, to prevent double encode on next insertWidget
                          setTimeout(function(){  
                            var templateValue = jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val();
                            templateValue = decodeURI(templateValue);
                            jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val(templateValue);                                                                                         
                          }, 200);                                                                                 
                                                                             
                      });                
                }, 1000);
                </script>                              
                ]]>
          </description>                    
          <block class="Magebird\Popup\Block\Adminhtml\Widget\NewsletterChooser">
              <data>
                  <item name="button" xsi:type="array">
                      <item name="open" xsi:type="string">Choose template...</item>
                  </item>
              </data>
          </block> 
      </parameter>  
			<parameter name="width" xsi:type="text"  visible="true" required="true" sort_order="3" >
				<label translate="true">Newsletter form width</label>
        <description><![CDATA[Set in pixels or percentage. Define the width value and select the necessary width unit in the field below.]]></description>
			</parameter>  
      <parameter name="width_unit" xsi:type="select" required="true" visible="true">
          <label translate="true">Newsletter form width unit</label>
          <description translate="true"><![CDATA[Select pixels, if you want to set the fixed width. Use % if you have responsive design for mobile and need a dynamic width.]]></description>
          <options>
              <option name="default" value="1" selected="true">
                  <label translate="true">Px</label>
              </option>
              <option name="item" value="2">
                  <label translate="true">Percentage (%)</label>
              </option>
          </options>
      </parameter>                        
			<parameter name="button_text" xsi:type="text"  visible="true" sort_order="4" >
				<label translate="true">Button text</label>
        <description>Leave empty for the default 'Subscribe' button text.</description>
			</parameter>
      <parameter name="show_checkbox" xsi:type="select" required="true" visible="true">
          <label translate="true">Show consent checkbox?</label>
          <description translate="true"><![CDATA[If you select Yes if you want to include consent checkbox into newsletter signup form.]]></description>
          <options>
              <option name="default" value="0" selected="true">
                  <label translate="true">No</label>
              </option>
              <option name="item" value="1">
                  <label translate="true">Yes</label>
              </option>
          </options>
      </parameter>    
      <parameter name="checkbox_text" xsi:type="text" required="false" visible="true" sort_order="5">
          <label translate="true">Checkbox agreement text</label>
          <description translate="true"><![CDATA[Write text that you want to be displayed beside checkbox.]]></description>
          <depends>
              <parameter name="show_checkbox" value="1" />
          </depends> 
      </parameter>                        
			<parameter name="button_color" xsi:type="text"  visible="true" sort_order="6">
				<label translate="true">Button color</label>
        <description><![CDATA[Use the Hex value and <a target="_blank" href="http://www.colorpicker.com/">Colorpicker.com</a> to pick color.]]></description>
			</parameter>
			<parameter name="button_text_color" xsi:type="text"  visible="true" sort_order="7" >
				<label translate="true">Button text color</label>
        <description><![CDATA[#FFFFFF (white) is the default value. Use the Hex value and <a target="_blank" href="http://www.colorpicker.com/">Colorpicker.com</a> to pick color.]]></description>
        <value>#FFFFFF</value>        
			</parameter>
      <parameter name="coupon_type" xsi:type="select" required="true" visible="true" sort_order="8">
          <label translate="true">Coupon type</label>
          <description><![CDATA[Choose if you want to send/display the coupon code to the subscribed users.]]></description>
          <options>
              <option name="none" value="0" selected="true">
                  <label translate="true">No coupon</label>
              </option>          
              <option name="one" value="1">
                  <label translate="true">Specific static coupon code</label>
              </option>
              <option name="two" value="2">
                  <label translate="true">Auto generate dynamic coupon code for each customer</label>
              </option>
          </options>          
      </parameter>                   
			<parameter name="coupon_code" xsi:type="text"  visible="true" sort_order="9" >
				<label translate="true">Coupon code</label>
        <description><![CDATA[Write coupon code you want to be sent to subscribed users. Make sure that this coupon exists.]]></description>
        <depends>
            <parameter name="coupon_type" value="1" />
        </depends>        
			</parameter> 
			<parameter name="rule_id" xsi:type="select" source_model="Magebird\Popup\Model\Widget\Source\Rules" visible="true" sort_order="10" >
				<label translate="true">Shopping Cart Price Rule ID for Coupon</label>
        <description><![CDATA[Choose your shoping cart rule you want to be used to generate coupons. Only rules with field <a href="http://www.magebird.com/magento-extensions/popup-2.html?tab=faq#dynamicCoupon">Use Auto Generation</a> checked on can be used. If you want to use static coupon code change "Coupon type" the above. See instructions <a href="http://www.magebird.com/magento-extensions/popup-2.html?tab=faq#dynamicCoupon">here</a>.]]></description>
        <depends>
            <parameter name="coupon_type" value="2" />
        </depends>        
			</parameter> 
			<parameter name="coupon_length" xsi:type="text"  visible="true" sort_order="11" >
				<label translate="true">Coupon length</label>
        <depends>
            <parameter name="coupon_type" value="2" />
        </depends>
        <value>12</value>         
			</parameter>      
			<parameter name="coupon_prefix" xsi:type="text"  visible="true" sort_order="12" >
				<label translate="true">Coupon prefix</label>
        <description>Leave empty if you don't want prefix</description>
        <depends>
            <parameter name="coupon_type" value="2" />
        </depends>
			</parameter>
			<parameter name="coupon_expiration" xsi:type="text"  visible="true" sort_order="13" >
				<label translate="true">Coupon expiration (in minutes)</label>
        <description><![CDATA[Leave empty if you want to use global settings from Shopping Cart Rule. Write minutes if you want coupon code to expire in defined minutes after user receives it. 1 day = 1440 minutes.]]></description>
        <depends>
            <parameter name="coupon_type" value="2" />
        </depends>       
			</parameter>        
      <parameter name="confirm_need" xsi:type="select" required="false" visible="true" sort_order="15">
          <label translate="true">Required subscription confirmation for the coupon</label>
          <description><![CDATA[For advanced use. Read the instructions first <a href="http://www.magebird.com/magento-extensions/popup-2.html?tab=faq#emailConfirmation" target="_blank">here</a> before you change this!]]></description>            
          <options>
              <option name="zero" value="0" selected="true">
                  <label translate="true">No</label>
              </option>          
              <option name="one" value="1">
                  <label translate="true">Yes</label>
              </option>
          </options>                  
      </parameter>           
      <parameter name="send_coupon" xsi:type="select" source_model="Magento\Config\Model\Config\Source\Yesno" required="true" visible="true" sort_order="16">
          <label translate="true">Send coupon to email</label>
          <description><![CDATA[You can display the coupon code inside the popup once the user subscribes. If you also want to send the coupon code to the user's email, choose Yes. The email template is located in app/code/Magebird/Popup/view/frontend/email/popup_coupon_newsletter.html]]></description>                 
      </parameter>  
      <parameter name="apply_coupon" xsi:type="select" required="true" visible="true" sort_order="17">
          <label translate="true">Auto-apply coupon to cart</label>
          <description>If set to Yes, the user doesn't need to enter the coupon code in cart, it'll get applied automatically.</description>
          <options>
              <option name="yes" value="1" selected="true">
                  <label translate="true">Yes</label>
              </option>          
              <option name="no" value="2">
                  <label translate="true">No</label>
              </option>
          </options>                  
      </parameter> 
      <parameter name="on_success" xsi:type="select" required="true" visible="true" sort_order="18">
          <label translate="true">Subscription success action</label>
          <description>Select the action to implement after the user subscribes to the newsletter.</description>           
          <options>
              <option name="one" value="1" selected="true">
                  <label translate="true">Display message (defined in the next field)</label>
              </option>          
              <option name="two" value="2">
                  <label translate="true">Display message and close popup</label>
              </option>     
              <option name="three" value="3">
                  <label translate="true">Display message and redirect to new page</label>
              </option>                            
          </options>                  
      </parameter> 
			<parameter name="success_url" xsi:type="text"  visible="true" sort_order="19" >
				<label translate="true">Redirect URL</label>
        <description>A location the visitor is sent after he/she subscribes. Leave empty if you want just to refresh the page.</description>
        <depends>
            <parameter name="on_success" value="3" />
        </depends>       
			</parameter>  
			<parameter name="redirect_delay" xsi:type="text"  visible="true" sort_order="20" >
				<label translate="true">Number of seconds before redirect</label>
        <depends>
            <parameter name="on_success" value="3" />
        </depends> 
        <value>2</value>      
			</parameter>             
			<parameter name="close_delay" xsi:type="text"  visible="true" sort_order="21" >
				<label translate="true">Close popup after how many seconds</label>
        <depends>
            <parameter name="on_success" value="2" />
        </depends> 
        <value>2</value>      
			</parameter>     
			<parameter name="success_msg" xsi:type="block"  visible="true" sort_order="22" >
				<label translate="true">Subscription follow-up message</label>
        <description><![CDATA[Text/content that will be shown after the user subscribes to the newsletter. To display the <b style="color:#f80000">coupon code</b> inside, use '<b>{{var coupon_code}}</b>'. {{var coupon_code}} will be then replaced with coupon code. Example: Your coupon is: {{var coupon_code}}. To get discount copy & paste it to offer code box in your shopping cart. Tip: HTML code is allowed. You can use the popup editor to design your content and then copy-paste it here.]]></description>      
        <block class="Magebird\Popup\Block\Adminhtml\Widget\SuccessMsg">                
        </block>              
			</parameter>             
 			<parameter name="mailchimp_list_id" xsi:type="text"  visible="true" sort_order="23" >
				<label translate="true">MailChimp List Id</label>
        <description translate="true"><![CDATA[Write only if you want to use MailChimp integration, otherwise leave empty. Go to <a target="_blank" href="http://admin.mailchimp.com/lists/">http://admin.mailchimp.com/lists/</a>, click the 'settings' link and find the ID at the bottom of the page. Make sure you add your MailChimp Api Key (Stores->Configuration->MAGEBIRD EXTENSIONS->Popup->Newsletter Services->Mailchimp Api Key)]]></description>
			</parameter>   
		</parameters>
	</widget>
  <widget id="popup_register" class="Magebird\Popup\Block\Widget\Register">
		<label translate="true">Magebird Popup Register</label>
		<description>Adds Register form into popup</description>
		<parameters>   
          <parameter name="widget_id" xsi:type="text" visible="false" required="true" sort_order="1" >
              <label translate="true">Widget id</label>
          </parameter> 
          <parameter name="template" xsi:type="block" required="true" visible="true" sort_order="2">
              <label translate="true">Register form template</label>  
              <block class="Magebird\Popup\Block\Adminhtml\Widget\RegisterChooser">
                  <data>
                      <item name="button" xsi:type="array">
                          <item name="open" xsi:type="string">Choose template...</item>
                      </item>
                  </data>
              </block>            
          </parameter>
    			<parameter name="width" xsi:type="text"  visible="true" required="true" sort_order="3" >
    				<label translate="true">Register form width</label>
            <description><![CDATA[Set in pixels or percentage. Define the width value and select the necessary width unit in the field below.]]></description>
    			</parameter>  
          <parameter name="width_unit" xsi:type="select" required="true" visible="true">
              <label translate="true">Register form width unit</label>
              <description translate="true"><![CDATA[Select pixels, if you want to set the fixed width. Use % if you have responsive design for mobile and need a dynamic width.]]></description>
              <options>
                  <option name="default" value="1" selected="true">
                      <label translate="true">Px</label>
                  </option>
                  <option name="item" value="2">
                      <label translate="true">Percentage (%)</label>
                  </option>
              </options>
          </parameter> 
    			<parameter name="button_text" xsi:type="text"  visible="true" sort_order="4" >
    				<label translate="true">Button text</label>
            <description>Leave empty for the default 'Register' button text.</description>
    			</parameter>      
    			<parameter name="button_color" xsi:type="text"  visible="true" sort_order="6">
    				<label translate="true">Button color</label>
            <description><![CDATA[Use the Hex value and <a target="_blank" href="http://www.colorpicker.com/">Colorpicker.com</a> to pick color.]]></description>
    			</parameter>
    			<parameter name="button_text_color" xsi:type="text"  visible="true" sort_order="7" >
    				<label translate="true">Button text color</label>
            <description><![CDATA[#FFFFFF (white) is the default value. Use the Hex value and <a target="_blank" href="http://www.colorpicker.com/">Colorpicker.com</a> to pick color.]]></description>
            <value>#FFFFFF</value>        
    			</parameter>
          <parameter name="newsletter_option" xsi:type="select" required="true" visible="true">
              <label translate="true">Newsletter option</label>
              <options>
                  <option name="one" value="1" selected="true">
                      <label translate="true">Don't show newsletter checkbox, automatically subscribe</label>
                  </option>
                  <option name="two" value="2">
                      <label translate="true">Show subscribe checkbox, subscribe if checked</label>
                  </option>
                  <option name="three" value="3">
                      <label translate="true">Don't show subscribe checkbox and don't subscribe</label>
                  </option>              
              </options>
          </parameter>  
    			<parameter name="checkbox_text" xsi:type="text"  visible="true" sort_order="8">
    				<label translate="true">Newsletter checkbox text</label>
            <description><![CDATA[Text beside newsletter checkbox. Default is 'Subscribe newsletter'.]]></description>            
            <depends>
                <parameter name="newsletter_option" value="2" />
            </depends>                   
            <value>Subscribe newsletter</value>
    			</parameter>      
          <parameter name="checkbox_checked" xsi:type="select" required="true" visible="true" sort_order="9">
              <label translate="true">Newsletter checkbox checked</label>
              <description><![CDATA[Should be newsletter checkbox checked by default?]]></description>
              <depends>
                  <parameter name="newsletter_option" value="2" />
              </depends>    
              <options>
                  <option name="default" value="1" selected="true">
                      <label translate="true">Yes</label>
                  </option>
                  <option name="item" value="2">
                      <label translate="true">No</label>
                  </option>             
              </options>                      
          </parameter>  
          <parameter name="coupon_option" xsi:type="select" required="true" visible="true" sort_order="10">
              <label translate="true">Coupon option</label>
                    <description>
                    <![CDATA[                 
                    <script>
                      jQuery('body').on('change', "#widget_options select[name='parameters\[coupon_type\]']", function(){                      
                        couponTypeListener();
                      });     
    
                      function couponTypeListener(){
                          var couponType = jQuery("#widget_options select[name='parameters\[coupon_type\]']").val();
                          if(couponType==0){
                            jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().hide();
                            jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().hide();
                            jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().hide();
                            
                            }else if (couponType==2){
                            jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().show();
                            jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().show();
                            jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().show();
                            
                          }else{
                            jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().hide();
                            jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().show();
                            jQuery("#widget_options select[name='parameters\[confirm_need\]']").parent().parent().show();
                          }    
                      } 
                                      
                    //belong to send_coupon field
                    setTimeout(function(){  
                      couponOptionListener();                                                
                    }, 200);                                                 
                    if ( jQuery.isFunction(jQuery.fn.on) ) {
                      jQuery('body').on('change', "#widget_options select[name='parameters\[coupon_option\]']", function(){                      
                        couponOptionListener();
                      });     
                    }else{
                      jQuery("#widget_options select[name='parameters\[coupon_option\]']").change(function() {
                        couponOptionListener();        
                      });    
                    }
                    function couponOptionListener(){
                        var couponOption = jQuery("#widget_options select[name='parameters\[coupon_option\]']").val();
                        if(couponOption==3){
                          jQuery("#widget_options input[name='parameters\[apply_coupon\]']").parent().parent().hide();
                          jQuery("#widget_options input[name='parameters\[coupon_code\]']").parent().parent().hide();                      
                          jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().hide();
                          jQuery("#widget_options select[name='parameters\[coupon_type\]']").parent().parent().hide();
                          jQuery("#widget_options select[name='parameters\[rule_id\]']").parent().parent().hide();                      
                        }else{
                          jQuery("#widget_options select[name='parameters\[apply_coupon\]']").parent().parent().show();
                          jQuery("#widget_options select[name='parameters\[send_coupon\]']").parent().parent().show();
                          jQuery("#widget_options select[name='parameters\[coupon_type\]']").parent().parent().show();
                          jQuery("#widget_options input[name='parameters\[coupon_code\]']").parent().parent().show();
                          jQuery("#widget_options select[name='parameters\[rule_id\]']").parent().parent().show();
                        }  
                        var couponType = jQuery("#widget_options select[name='parameters\[coupon_type\]']").val();
                        if(couponType==1){                    
                          jQuery("#widget_options select[name='parameters\[rule_id\]']").parent().parent().hide();
                        }else{
                          jQuery("#widget_options input[name='parameters\[coupon_code\]']").parent().parent().hide();
                        }  
                    }    
                    </script> 
                    <script>                                      
                      setTimeout(function(){          
                          jQuery("#widget_options input[name='parameters\[widget_id\]']").val("_"+Math.random().toString(36).substr(2, 4));
                          //belong to success_msg field                    
                          jQuery("#insert_button").attr('onclick','').unbind('click');
                          jQuery("#insert_button").click(function(){
                              setTimeout(function(){
                                var templateValue = jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val();
                                templateValue = encodeURI(templateValue).replace(/'/g, "%27"); 
                                jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val(templateValue);                                                               
                                wWidget.insertWidget()                          
                              }, 100);   
                              //for case if error appeared, to prevent double encode on next insertWidget
                              setTimeout(function(){  
                                var templateValue = jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val();
                                templateValue = decodeURI(templateValue);
                                jQuery("#widget_options textarea[name='parameters\[success_msg\]']").val(templateValue);                                                                                         
                              }, 200);                                                                                 
                                                                                 
                          });                
                    }, 1000);
                    </script>                                   
                    ]]>
                    </description>  
              <options>
                  <option name="default" value="1" selected="true">
                      <label translate="true">Show/send coupon for registration</label>
                  </option>
                  <option name="two" value="2">
                      <label translate="true">Show/send coupon only if user also subscribes newsletter</label>
                  </option>   
                  <option name="three" value="3">
                      <label translate="true">No coupon</label>
                  </option>                         
              </options>            
          </parameter>              
          <parameter name="coupon_type" xsi:type="select" required="true" visible="true" sort_order="11">
              <label translate="true">Coupon type</label>
              <description><![CDATA[Select to send/display a coupon code after the user clicks the button.]]></description>
              <options>
                  <option name="one" value="0" selected="true">
                      <label translate="true">No coupon</label>
                  </option>
                  <option name="two" value="1">
                      <label translate="true">Specific static coupon code</label>
                  </option>
                  <option name="three" value="2">
                      <label translate="true">Auto generate dynamic coupon code for each customer</label>
                  </option>              
              </options>
          </parameter>                     
       
    			<parameter name="coupon_code" xsi:type="text"  visible="true" sort_order="12">
    				<label translate="true">Coupon code</label>
            <description><![CDATA[Write coupon code you want to be sent to newly registered users]]></description>
            <depends>
                <parameter name="coupon_type" value="1" />
            </depends>               
    			</parameter>  
    			<parameter name="rule_id" xsi:type="select" source_model="Magebird\Popup\Model\Widget\Source\Rules" visible="true" sort_order="13" >
    				<label translate="true">Shopping Cart Price Rule ID for Coupon</label>                              
            <description><![CDATA[Choose your shoping cart rule you want to be used to generate coupons. Only rules with field <a href="http://www.magebird.com/magento-extensions/popup-2.html?tab=faq#dynamicCoupon">Use Auto Generation</a> checked on can be used. If you want to use static coupon code change "Coupon type" the above. See instructions <a href="http://www.magebird.com/magento-extensions/popup-2.html?tab=faq#dynamicCoupon">here</a>.]]></description>
            <depends>
                <parameter name="coupon_type" value="2" />
            </depends>        
    			</parameter> 
    			<parameter name="coupon_length" xsi:type="text"  visible="true" sort_order="14" >
    				<label translate="true">Coupon length</label>
            <depends>
                <parameter name="coupon_type" value="2" />
            </depends>  
            <value>12</value>             
    			</parameter> 
    			<parameter name="coupon_prefix" xsi:type="text"  visible="true" sort_order="15" >
    				<label translate="true">Coupon prefix</label>
            <description><![CDATA[Leave empty if you don't want prefix]]></description>
            <depends>
                <parameter name="coupon_type" value="2" />
            </depends>               
    			</parameter>  
    			<parameter name="coupon_expiration" xsi:type="text"  visible="true" sort_order="16" >
    				<label translate="true">Coupon expiration (in minutes)</label>
            <description><![CDATA[Leave empty if you want to use global settings from Shopping Cart Rule. Write minutes if you want coupon code to expire in defined minutes after user receives it. 1 day = 1440 minutes.]]></description>
            <depends>
                <parameter name="coupon_type" value="2" />
            </depends>       
    			</parameter>                                   
          <parameter name="send_coupon" xsi:type="select" source_model="Magento\Config\Model\Config\Source\Yesno" required="true" visible="true" sort_order="17">
              <label translate="true">Send coupon to email</label>
              <description><![CDATA[You can display the coupon code inside the popup once the user registers. If you also want to send the coupon code to the user's email, choose Yes. The email template is located in app/code/Magebird/Popup/view/frontend/email/popup_coupon_newsletter.html]]></description>                 
          </parameter>  
          <parameter name="apply_coupon" xsi:type="select" required="true" visible="true" sort_order="18">
              <label translate="true">Auto-apply coupon to cart</label>
              <description><![CDATA[If set to Yes, the user doesn't need to enter the coupon code in cart, it'll get applied automatically.]]></description>
              <options>
                  <option name="yes" value="1" selected="true">
                      <label translate="true">Yes</label>
                  </option>
                  <option name="no" value="2">
                      <label translate="true">No</label>
                  </option>            
              </options>
          </parameter>                   
          <parameter name="on_success" xsi:type="select" required="true" visible="true" sort_order="19">
              <label translate="true">On success action</label>
              <description>What action should be taken after user registers</description>           
              <options>
                  <option name="one" value="1" selected="true">
                      <label translate="true">Display message (defined in the next field)</label>
                  </option>          
                  <option name="two" value="2">
                      <label translate="true">Display message and close popup</label>
                  </option>     
                  <option name="three" value="3">
                      <label translate="true">Display message and redirect to new page</label>
                  </option>                            
              </options>                  
          </parameter>                                                      
    			<parameter name="success_url" xsi:type="text"  visible="true" sort_order="20" >
    				<label translate="true">Redirect URL</label>
            <description>A location the visitor is sent after he/she registers. Leave empty if you want just to refresh the page.</description>
            <depends>
                <parameter name="on_success" value="3" />
            </depends>       
    			</parameter>  
    			<parameter name="redirect_delay" xsi:type="text"  visible="true" sort_order="21" >
    				<label translate="true">Number of seconds before redirect</label>
            <depends>
                <parameter name="on_success" value="3" />
            </depends> 
            <value>2</value>      
    			</parameter>             
    			<parameter name="close_delay" xsi:type="text"  visible="true" sort_order="22" >
    				<label translate="true">Close popup after how many seconds</label>
            <depends>
                <parameter name="on_success" value="2" />
            </depends> 
            <value>2</value>      
    			</parameter>  
    			<parameter name="success_msg" xsi:type="block"  visible="true" sort_order="23" >
    				<label translate="true">Text/content after registration</label>        
            <description><![CDATA[Text/content that will be shown after user registers. To display <b style="color:#f80000">coupon code</b> inside use '<b>{{var coupon_code}}</b>'. {{var coupon_code}} will be then replaced with coupon code. Example: <i><span>Your coupon is: {{var coupon_code}}. To get discount copy & paste it to offer code box in your shopping cart.</i></span><br />Tip: Html code is allowed. You can use popup editor to design your content and then copy html here.]]></description>
            <block class="Magebird\Popup\Block\Adminhtml\Widget\SuccessMsg">                
            </block>                                                
    			</parameter> 
     			<parameter name="mailchimp_list_id" xsi:type="text"  visible="true" sort_order="24" >
    				<label translate="true">MailChimp List Id</label>
            <description translate="true"><![CDATA[Write only if you want to use MailChimp integration, otherwise leave empty. Go to <a target="_blank" href="http://admin.mailchimp.com/lists/">http://admin.mailchimp.com/lists/</a>, click the 'settings' link and find the ID at the bottom of the page. Make sure you add your MailChimp Api Key (Stores->Configuration->MAGEBIRD EXTENSIONS->Popup->Newsletter Services->Mailchimp Api Key)]]></description>
    			</parameter>                                                                                                                                                                           
        </parameters>
    </widget>  
</widgets> 